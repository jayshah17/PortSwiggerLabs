## Lab Description: Exploiting XInclude to retrieve files

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/f99c5fe8-618c-4494-a43c-c1cdf78500d8)

## Solution: 

XInclude attacks

Some applications receive client-submitted data, embed it on the server-side into an XML document, and then parse the document. An example of this occurs when client-submitted data is placed into a back-end SOAP request, which is then processed by the backend SOAP service.

In this situation, you cannot carry out a classic XXE attack, because you don't control the entire XML document and so cannot define or modify a DOCTYPE element. However, you might be able to use XInclude.

XInclude is a part of the XML specification that allows an XML document to be built from sub-documents. You can place an XInclude attack within any data value in an XML document, so the attack can be performed in situations where you only control a single item of data that is placed into a server-side XML document.

To test for XInclude attacks, insert the following payload into the data entry point and see if the file that you requested gets sent back in the response body:

<example xmlns:xi="http://www.w3.org/2001/XInclude">
 <xi:include parse="text" href="file:///etc/hostname"/>
</example>
This piece of XML code does two things. First, it references the http://www.w3.org/2001/XInclude namespace so that we can use the xi:include element. Next, it uses that element to parse and include the /etc/hostname` file in the XML document

Visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/f8bdba0c-3d58-47a7-b98d-48bae6dc0792)

Set the value of the productId parameter to:

```
<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>
```
![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/712983de-1302-424f-9574-e29821f8560c)

Lab Solved

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/1977f55c-034f-4f6f-b5da-e7be9c04dad5)

